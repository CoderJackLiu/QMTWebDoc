<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XtQuant 账户管理模块</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f8f9fa;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            min-height: 100vh;
        }
        
        .sidebar {
            width: 280px;
            background: white;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 1000;
        }
        
        .sidebar-header {
            padding: 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .sidebar-header h2 {
            font-size: 1.2rem;
            margin-bottom: 5px;
        }
        
        .sidebar-header p {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .nav-menu {
            padding: 20px 0;
        }
        
        .nav-section {
            margin-bottom: 20px;
        }
        
        .nav-section h3 {
            padding: 10px 20px;
            font-size: 0.9rem;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 1px solid #eee;
        }
        
        .nav-section ul {
            list-style: none;
        }
        
        .nav-section li {
            margin: 2px 0;
        }
        
        .nav-section a {
            display: block;
            padding: 8px 20px;
            color: #555;
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .nav-section a:hover {
            background: #f0f0f0;
            color: #667eea;
            padding-left: 25px;
        }
        
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 40px;
        }
        
        .page-header {
            margin-bottom: 40px;
            text-align: center;
        }
        
        .page-header h1 {
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .page-header p {
            font-size: 1.1rem;
            color: #666;
        }
        
        .api-section {
            background: white;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .api-section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
            font-size: 1.8rem;
        }
        
        .api-method {
            margin-bottom: 40px;
            padding: 20px;
            border: 1px solid #e1e8ed;
            border-radius: 8px;
            background: #fafbfc;
        }
        
        .api-method h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .method-signature {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            margin-bottom: 15px;
            overflow-x: auto;
        }
        
        .method-info {
            margin-bottom: 15px;
        }
        
        .method-info h4 {
            color: #4a5568;
            margin-bottom: 8px;
            font-size: 1rem;
        }
        
        .method-info p, .method-info li {
            color: #666;
            line-height: 1.6;
        }
        
        .method-info ul {
            margin-left: 20px;
        }
        
        .code-example {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            margin-top: 15px;
            overflow-x: auto;
        }
        
        .back-link {
            display: inline-block;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 500;
            margin-bottom: 30px;
            transition: all 0.3s ease;
        }
        
        .back-link:hover {
            background: linear-gradient(135deg, #5a6fd8, #6a4190);
            transform: translateY(-2px);
        }
        
        .highlight {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .highlight strong {
            color: #856404;
        }
        
        .workflow {
            background: #e8f4fd;
            border: 1px solid #bee5eb;
            border-radius: 6px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .workflow h4 {
            color: #0c5460;
            margin-bottom: 10px;
        }
        
        .workflow ol {
            margin-left: 20px;
            color: #0c5460;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>账户管理模块</h2>
                <p>连接与账户管理API</p>
            </div>
            <nav class="nav-menu">
                <div class="nav-section">
                    <h3>连接管理</h3>
                    <ul>
                        <li><a href="#connect">连接服务器</a></li>
                        <li><a href="#start">启动API</a></li>
                        <li><a href="#stop">停止API</a></li>
                        <li><a href="#run_forever">运行循环</a></li>
                    </ul>
                </div>
                <div class="nav-section">
                    <h3>账户订阅</h3>
                    <ul>
                        <li><a href="#subscribe">订阅账户</a></li>
                        <li><a href="#register_callback">注册回调</a></li>
                    </ul>
                </div>
                <div class="nav-section">
                    <h3>账户查询</h3>
                    <ul>
                        <li><a href="#query_account_infos">账号信息查询</a></li>
                        <li><a href="#query_account_status">账号状态查询</a></li>
                        <li><a href="#query_com_fund">普通柜台资金查询</a></li>
                    </ul>
                </div>
            </nav>
        </div>
        
        <div class="main-content">
            <a href="xtquant_api_modules.html" class="back-link">← 返回模块首页</a>
            
            <div class="page-header">
                <h1>账户管理模块</h1>
                <p>连接管理与账户相关API接口文档</p>
            </div>
            
            <div class="workflow">
                <h4>典型使用流程</h4>
                <ol>
                    <li>创建XtQuantTrader实例</li>
                    <li>注册回调函数 (register_callback)</li>
                    <li>连接服务器 (connect)</li>
                    <li>启动API (start)</li>
                    <li>订阅账户 (subscribe)</li>
                    <li>开始事件循环 (run_forever)</li>
                    <li>程序结束时停止API (stop)</li>
                </ol>
            </div>
            
            <div class="api-section">
                <h2>连接管理接口</h2>
                
                <div class="api-method" id="connect">
                    <h3>连接服务器</h3>
                    <div class="method-signature">connect()</div>
                    
                    <div class="method-info">
                        <h4>功能说明</h4>
                        <p>连接到XtQuant交易服务器，建立通信链路。</p>
                        
                        <h4>参数</h4>
                        <p>无参数</p>
                        
                        <h4>返回值</h4>
                        <ul>
                            <li><strong>0</strong>: 连接成功</li>
                            <li><strong>-1</strong>: 连接失败</li>
                        </ul>
                        
                        <div class="highlight">
                            <strong>注意:</strong> 必须在调用其他交易接口之前先建立连接。
                        </div>
                        
                        <h4>示例代码</h4>
                        <div class="code-example">
# 创建交易实例
xt_trader = XtQuantTrader()

# 连接服务器
connect_result = xt_trader.connect()

if connect_result == 0:
    print("连接成功")
else:
    print("连接失败")
    exit()
                        </div>
                    </div>
                </div>
                
                <div class="api-method" id="start">
                    <h3>启动API</h3>
                    <div class="method-signature">start()</div>
                    
                    <div class="method-info">
                        <h4>功能说明</h4>
                        <p>启动XtQuant API服务，初始化交易环境。</p>
                        
                        <h4>参数</h4>
                        <p>无参数</p>
                        
                        <h4>返回值</h4>
                        <p>无返回值</p>
                        
                        <h4>示例代码</h4>
                        <div class="code-example">
# 启动API服务
xt_trader.start()
print("API服务已启动")
                        </div>
                    </div>
                </div>
                
                <div class="api-method" id="stop">
                    <h3>停止API</h3>
                    <div class="method-signature">stop()</div>
                    
                    <div class="method-info">
                        <h4>功能说明</h4>
                        <p>停止XtQuant API服务，释放相关资源。</p>
                        
                        <h4>参数</h4>
                        <p>无参数</p>
                        
                        <h4>返回值</h4>
                        <p>无返回值</p>
                        
                        <div class="highlight">
                            <strong>建议:</strong> 程序退出前调用此方法，确保资源正确释放。
                        </div>
                        
                        <h4>示例代码</h4>
                        <div class="code-example">
# 程序结束时停止API
try:
    # 主要业务逻辑
    pass
finally:
    xt_trader.stop()
    print("API服务已停止")
                        </div>
                    </div>
                </div>
                
                <div class="api-method" id="run_forever">
                    <h3>运行循环</h3>
                    <div class="method-signature">run_forever()</div>
                    
                    <div class="method-info">
                        <h4>功能说明</h4>
                        <p>启动事件循环，保持程序运行并处理回调事件。</p>
                        
                        <h4>参数</h4>
                        <p>无参数</p>
                        
                        <h4>返回值</h4>
                        <p>无返回值（阻塞调用）</p>
                        
                        <div class="highlight">
                            <strong>注意:</strong> 这是一个阻塞调用，会一直运行直到程序被终止。
                        </div>
                        
                        <h4>示例代码</h4>
                        <div class="code-example">
# 启动事件循环
print("开始运行交易程序...")
xt_trader.run_forever()
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="api-section">
                <h2>账户订阅接口</h2>
                
                <div class="api-method" id="subscribe">
                    <h3>订阅账户</h3>
                    <div class="method-signature">subscribe(account)</div>
                    
                    <div class="method-info">
                        <h4>功能说明</h4>
                        <p>订阅指定账户，接收该账户的交易回调和状态变化通知。</p>
                        
                        <h4>参数</h4>
                        <ul>
                            <li><strong>account</strong> (StockAccount): 要订阅的资金账号对象</li>
                        </ul>
                        
                        <h4>返回值</h4>
                        <p>无返回值</p>
                        
                        <h4>示例代码</h4>
                        <div class="code-example">
# 创建账户对象
account = StockAccount('123456789')

# 订阅账户
xt_trader.subscribe(account)
print(f"已订阅账户: {account.account_id}")
                        </div>
                    </div>
                </div>
                
                <div class="api-method" id="register_callback">
                    <h3>注册回调</h3>
                    <div class="method-signature">register_callback(callback)</div>
                    
                    <div class="method-info">
                        <h4>功能说明</h4>
                        <p>注册回调处理器，用于接收交易事件和状态变化通知。</p>
                        
                        <h4>参数</h4>
                        <ul>
                            <li><strong>callback</strong> (XtQuantTraderCallback): 回调处理器实例</li>
                        </ul>
                        
                        <h4>返回值</h4>
                        <p>无返回值</p>
                        
                        <h4>示例代码</h4>
                        <div class="code-example">
# 创建回调处理器
class MyCallback(XtQuantTraderCallback):
    def on_order_error(self, order_error):
        print(f"下单失败: {order_error.error_msg}")
    
    def on_account_status(self, account_status):
        print(f"账户状态: {account_status.account_id} - {account_status.status}")

# 注册回调
callback = MyCallback()
xt_trader.register_callback(callback)
print("回调处理器已注册")
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="api-section">
                <h2>账户查询接口</h2>
                
                <div class="api-method" id="query_account_infos">
                    <h3>账号信息查询</h3>
                    <div class="method-signature">query_account_infos()</div>
                    
                    <div class="method-info">
                        <h4>功能说明</h4>
                        <p>查询所有可用的资金账号信息。</p>
                        
                        <h4>参数</h4>
                        <p>无参数</p>
                        
                        <h4>返回值</h4>
                        <p>XtAccountInfo对象列表，包含账号基本信息</p>
                        
                        <h4>示例代码</h4>
                        <div class="code-example">
# 查询所有账号信息
account_infos = xt_trader.query_account_infos()

if account_infos:
    for info in account_infos:
        print(f"账号ID: {info.account_id}")
        print(f"账号类型: {info.account_type}")
        print(f"账号名称: {info.account_name}")
        print("-" * 30)
else:
    print("未找到账号信息")
                        </div>
                    </div>
                </div>
                
                <div class="api-method" id="query_account_status">
                    <h3>账号状态查询</h3>
                    <div class="method-signature">query_account_status()</div>
                    
                    <div class="method-info">
                        <h4>功能说明</h4>
                        <p>查询所有账号的当前状态信息。</p>
                        
                        <h4>参数</h4>
                        <p>无参数</p>
                        
                        <h4>返回值</h4>
                        <p>XtAccountStatus对象列表，包含账号状态信息</p>
                        
                        <h4>示例代码</h4>
                        <div class="code-example">
# 查询所有账号状态
account_statuses = xt_trader.query_account_status()

if account_statuses:
    for status in account_statuses:
        print(f"账号ID: {status.account_id}")
        print(f"连接状态: {status.status}")
        print(f"最后更新时间: {status.last_update_time}")
        print("-" * 30)
else:
    print("未找到账号状态信息")
                        </div>
                    </div>
                </div>
                
                <div class="api-method" id="query_com_fund">
                    <h3>普通柜台资金查询</h3>
                    <div class="method-signature">query_com_fund(account)</div>
                    
                    <div class="method-info">
                        <h4>功能说明</h4>
                        <p>查询普通柜台账户的资金信息，适用于非信用账户。</p>
                        
                        <h4>参数</h4>
                        <ul>
                            <li><strong>account</strong> (StockAccount): 普通资金账号对象</li>
                        </ul>
                        
                        <h4>返回值</h4>
                        <p>资金信息对象或None</p>
                        
                        <div class="highlight">
                            <strong>说明:</strong> 此接口专门用于查询普通柜台的资金信息，与信用账户的资金查询接口不同。
                        </div>
                        
                        <h4>示例代码</h4>
                        <div class="code-example">
# 创建普通账户对象
account = StockAccount('123456789', 'STOCK')

# 查询普通柜台资金
fund_info = xt_trader.query_com_fund(account)

if fund_info:
    print(f"总资产: {fund_info.total_asset}")
    print(f"可用资金: {fund_info.cash_available}")
    print(f"冻结资金: {fund_info.cash_frozen}")
    print(f"市值: {fund_info.market_value}")
else:
    print("查询资金信息失败")
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="api-section">
                <h2>完整使用示例</h2>
                
                <div class="api-method">
                    <h3>完整的账户管理流程</h3>
                    
                    <div class="method-info">
                        <h4>示例代码</h4>
                        <div class="code-example">
from xtquant.xttrader import XtQuantTrader, XtQuantTraderCallback
from xtquant.xttype import StockAccount

# 创建回调处理器
class MyTraderCallback(XtQuantTraderCallback):
    def on_account_status(self, account_status):
        print(f"账户状态变化: {account_status.account_id} - {account_status.status}")
    
    def on_order_error(self, order_error):
        print(f"下单失败: {order_error.error_msg}")

def main():
    # 1. 创建交易实例
    xt_trader = XtQuantTrader()
    
    # 2. 注册回调
    callback = MyTraderCallback()
    xt_trader.register_callback(callback)
    
    # 3. 连接服务器
    connect_result = xt_trader.connect()
    if connect_result != 0:
        print("连接失败")
        return
    
    # 4. 启动API
    xt_trader.start()
    
    # 5. 查询账号信息
    account_infos = xt_trader.query_account_infos()
    if account_infos:
        print("可用账号:")
        for info in account_infos:
            print(f"  {info.account_id} - {info.account_type}")
    
    # 6. 订阅账户（假设使用第一个账户）
    if account_infos:
        account = StockAccount(account_infos[0].account_id)
        xt_trader.subscribe(account)
        print(f"已订阅账户: {account.account_id}")
    
    try:
        # 7. 开始事件循环
        print("开始运行交易程序...")
        xt_trader.run_forever()
    except KeyboardInterrupt:
        print("程序被用户中断")
    finally:
        # 8. 停止API
        xt_trader.stop()
        print("API服务已停止")

if __name__ == "__main__":
    main()
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>